<div class="register-popup">
  <div class="register-body-popup">
    <div class="signup-container">
      <div class="signup-box">
        <h2>Change password</h2>

        <form [formGroup]="passwordForm" (ngSubmit)="saveChanges()">
          <div class="form-row">
            <div class="form-field">
              <input
                type="password"
                id="old-password"
                placeholder="Current password"
                formControlName="oldPassword"
              />
              <div
                *ngIf="passwordForm.get('oldPassword')?.invalid && passwordForm.get('oldPassword')?.touched"
                class="error-message"
              >
                Current password is required.
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-field">
              <input
                type="password"
                id="new-password"
                placeholder="New password"
                formControlName="newPassword"
              />
              <div
                *ngIf="passwordForm.get('newPassword')?.invalid && passwordForm.get('newPassword')?.touched"
                class="error-message"
              >
                <span *ngIf="passwordForm.get('newPassword')?.errors?.['required']">
                  New password is required.
                </span>
                <span *ngIf="passwordForm.get('newPassword')?.errors?.['minlength']">
                  New password must be at least 6 characters long.
                </span>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-field">
              <input
                type="password"
                id="re-password"
                placeholder="Re-enter new password"
                formControlName="rePassword"
              />

              <div
                *ngIf="passwordForm.get('rePassword')?.invalid && passwordForm.get('rePassword')?.touched"
                class="error-message"
              >
                <span *ngIf="passwordForm.get('rePassword')?.errors?.['required']">
                  Re-entering new password is required.
                </span>
                <span *ngIf="passwordForm.errors?.['mismatch'] && passwordForm.get('rePassword')?.dirty">
                  Passwords do not match.
                </span>
              </div>
            </div>
          </div>

          <button
            class="register-btn"
            type="submit"
            [disabled]="passwordForm.invalid || isLoading"
          >
            {{ isLoading ? 'Saving...' : 'Save changes' }}
          </button>
          <button class="back-btn" type="button" (click)="closeDialog()">Back</button>
        </form>
      </div>
    </div>
  </div>
</div>